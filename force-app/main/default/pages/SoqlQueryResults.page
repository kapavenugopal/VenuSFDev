<apex:page controller="VG_QueryResultsGenerator">
    <apex:form id="od">
        <apex:pageBlock >
            <apex:pageBlockSection columns="1">
            <apex:pageBlockSectionItem >
                <apex:outputLabel > Select Object</apex:outputLabel>
                <apex:selectList size="1" value="{!selectedObject }">
                    <apex:selectOptions value="{!objects }"></apex:selectOptions>
                    <apex:actionSupport event="onchange" action="{!details}" rerender="od, fields"/>
                </apex:selectList>
                       
            </apex:pageBlockSectionItem>
                
                
            <apex:pageBlockSectionItem id="fields"> 
                <apex:panelGrid columns="4">
                <apex:outputText >Select Fields</apex:outputText>
                    <apex:panelGroup style="width:40%">
                        <!--Select Fields-->
                        <apex:selectList multiselect="true" size="5" value="{!sFields}" style="width:120px;height:120px;">
                            <apex:selectOptions value="{!fnsOptions}"></apex:selectOptions>
                        </apex:selectList>
                    </apex:panelGroup>
                    
                    <apex:panelGroup style="width:20%;height:120px;">
                        <table height="120px">
                            <tr>
                                <td><apex:commandButton value="Add" action="{!add}" style="width:80px" reRender="od"/></td>
                                
                            </tr>
                            <tr>
                                <td><apex:commandButton value="Remove" action="{!remove}" style="width:80px" reRender="od"/></td>
                            </tr>
                        </table>
                    </apex:panelGroup>
                    
                    <apex:panelGroup style="width:40%">
                        <apex:selectList multiselect="true" size="5" value="{!rFields}" style="width:120px;height:120px;">
                            <apex:selectOptions value="{!fsOptions}"></apex:selectOptions>
                        </apex:selectList>
                    </apex:panelGroup>
                
                </apex:panelGrid>          
                <!--<apex:outputLabel > Select Fields</apex:outputLabel>-->
                
            </apex:pageBlockSectionItem>
            
            <apex:pageBlockSectionItem >
                <apex:commandButton value="Get Records" action="{!queryRecords}" reRender="od"/>
                {!query}
            </apex:pageBlockSectionItem>
            
            <apex:pageBlockSectionItem id="table">
            
                <apex:pageBlockTable value="{!records}" var="a">
                    <!--<apex:column value="{!a.Id}"/>-->
                    <apex:repeat value="{!fieldsSelected}" var="b">
                        <apex:column value="{!a[b]}"/>
                    </apex:repeat>
                
                </apex:pageBlockTable>
            </apex:pageBlockSectionItem>
                <apex:outputPanel id="paginationButtons">
                    <apex:commandButton value="First Page" rerender="od, table" action="{!FirstPage}" disabled="{!prev}"/>
                    <apex:commandButton value="Previous" rerender="od, table" action="{!previous}" disabled="{!prev}"/>
                    <apex:outputText value="Page {!pageNumber} of {!totalPages}" id="totalPageNumber"/>
                    <apex:commandButton value="Next" rerender="od, table" action="{!next}" disabled="{!nxt}"/>
                    <apex:commandButton value="Last Page" rerender="od, table" action="{!LastPage}" disabled="{!nxt}"/>
                </apex:outputPanel>
                
            </apex:pageBlockSection>
            <apex:pageMessages ></apex:pageMessages>
        </apex:pageBlock>
    </apex:form>
</apex:page>